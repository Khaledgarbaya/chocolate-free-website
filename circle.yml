machine:
  environment:
    FILE_NAME: index-$(date "+%s").html
  node:
    version: 4.0.0
dependencies:
  override:
    - npm install
checkout:
  post:
    - aws configure set preview.cloudfront true
    - aws configure set preview.create-invalidation true
test:
  override:
    - echo "test"
    
deployment:
  prod:
    branch: master
    commands:
      - npm start
      - mv build/index.html build/$FILE_NAME
      - aws s3 sync build s3://chocolate-free.com --delete
      - aws s3 website s3://chocolate-free.com --index-document $FILE_NAME
